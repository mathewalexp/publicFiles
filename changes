val alertsDS: Dataset[Alert] = df.map(row => {
  val alert = new Alert()
  alert.setId(row.getAs[Int]("id"))  // Use appropriate types
  alert.setName(row.getAs[String]("name"))
  alert
})(Encoders.javaSerialization(classOf[Alert]))

// Convert to List
val alertsList: List[Alert] = alertsDS.collect().toList
