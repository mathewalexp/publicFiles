val csvString =
  """name,age,city
    |Alice,30,New York
    |Bob,25,San Francisco
    |Charlie,35,Los Angeles""".stripMargin

// Convert the CSV string to an RDD
val csvRDD = spark.sparkContext.parallelize(csvString.split("\n"))

// Use the first line as header
val header = csvRDD.first()

// Create the DataFrame by using the schema
val df = spark.createDataFrame(
  csvRDD.filter(row => row != header).map(_.split(",")) // Split the CSV rows
    .map(arr => Row(arr(0), arr(1).toInt, arr(2))), // Convert to Row
  StructType(Seq(
    StructField("name", StringType, nullable = true),
    StructField("age", IntegerType, nullable = true),
    StructField("city", StringType, nullable = true)
  ))
)
